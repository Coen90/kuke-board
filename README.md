## 샤드 전략

Range-based Sharding(범위 기반 샤딩)
- 데이터를 특정 값(shard key)을 기준으로 범위를 나누어 여러 샤드에 분산하는 방식
  - 예) 좌측샤드: id: 1~5000, 우측샤드: id: 5001~10000
  - 장점
    - 범위 데이터 조회에 유리
  - 단점
    - 데이터 쏠림 현상

Hash-based Sharding(해시 기반 샤딩)
- 데이터를 해시 함수를 통해 특정 값(shard key)을 기준으로 샤드에 분산하는 방식
  - 예) 해시함수(id) % 2
  - 장점
    - 데이터 균등 분산
  - 단점
    - 범위 데이터 조회에 불리

Directory-based Sharding(디렉토리 기반 샤딩)
- 디렉토리를 이용하여 데이터가 저장된 샤드를 관리하는 기법
  - 예) 디렉토리: id_1, id_2, id_3
  - 장점
    - 데이터 규모에 따라 유연한 관리 가능
  - 단점
    - 디렉토리 관리 비용 증가

물리적 샤드
- hash -> id % 2 -> 2개의 샤드
- hash -> id % 4 로 변경하는 경우
- 기존 샤드에서 3, 4번째 id를 변경해야 한다.
- 디비를 변경하는 경우에 어플리케이션 코드 변경도 필요하다.

논리적 샤드
- 물리적으로는 2개의 샤드가 있지만 논리적으로는 4개의 샤드로 관리
- 클라이언트는 라우터에 요청을 하게 되고, 라우터는 논리적 샤드로 매핑하여 요청을 전달한다.
- 실제로 물리적 샤드가 늘어나면 라우터만 변경하면 된다.

데이터 복제
- 고가용성, 안정성, 성능 문제 해결
- case study 특정 샤드에 장애 발생
  - 데이터 복제본
  - primary에 데이터 쓰고 replica에 데이터 복제
    - 복제는 동기적 비동기적으로 처리
    - 동기적 -> 데이터 일관성 보장, 쓰기 성능 저하
    - 비동기적 -> 쓰기 성능 유지, 복제본에 최신 데이터 즉시 반영되지 않을 수 있다.
  - 고가용성을 위해 다른 지역 데이터센터에 관리할수도 있다.

분산 시스템에서 추가적인/확장된 개념이나 고려할 부분은 더욱 많다.
